# =============================================================================
# Modern, sensible tmux config - "just get shit done" edition
# =============================================================================

# -----------------------------------------------------------------------------
# Fix the BS defaults
# -----------------------------------------------------------------------------

# Start windows and panes at 1, not 0 (matches keyboard layout)
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when one is closed (no gaps)
set -g renumber-windows on

# Remove the escape delay (makes vim/editors feel snappy)
set -sg escape-time 0

# Increase scrollback buffer (default 2000 is tiny)
set -g history-limit 50000

# Enable mouse support (scroll, click to select pane, resize panes)
set -g mouse on

# Fix colors - use true color if terminal supports it
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

# Don't let programs rename windows
set -g allow-rename off

# Activity monitoring - subtle, not annoying
setw -g monitor-activity on
set -g visual-activity off

# -----------------------------------------------------------------------------
# Better prefix key
# -----------------------------------------------------------------------------

# Change prefix from Ctrl+b to Ctrl+a (easier to reach)
# (You can still use Ctrl+b if muscle memory - both work)
set -g prefix C-a
set -g prefix2 C-b
bind C-a send-prefix

# -----------------------------------------------------------------------------
# Intuitive splits (like VS Code)
# -----------------------------------------------------------------------------

# Split panes with | and - (more intuitive than % and ")
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind \\ split-window -h -c "#{pane_current_path}"  # No shift needed

# New windows open in current directory
bind c new-window -c "#{pane_current_path}"

# -----------------------------------------------------------------------------
# Easy pane navigation (vim-style or arrow keys)
# -----------------------------------------------------------------------------

# Arrow keys (no prefix needed with -n)
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# Vim-style hjkl (with prefix)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Resize panes with Shift+Arrow (no prefix)
bind -n S-Left resize-pane -L 2
bind -n S-Right resize-pane -R 2
bind -n S-Up resize-pane -U 2
bind -n S-Down resize-pane -D 2

# -----------------------------------------------------------------------------
# Window navigation
# -----------------------------------------------------------------------------

# Switch windows with Alt+number (no prefix needed)
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5
bind -n M-6 select-window -t 6
bind -n M-7 select-window -t 7
bind -n M-8 select-window -t 8
bind -n M-9 select-window -t 9

# Prev/Next window
bind -n M-[ previous-window
bind -n M-] next-window

# -----------------------------------------------------------------------------
# Copy mode that doesn't suck (macOS clipboard integration)
# -----------------------------------------------------------------------------

# Use vim keybindings in copy mode
setw -g mode-keys vi

# Enter copy mode with prefix + [
# v to start selection, y to copy, q to quit
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "pbcopy"

# Double-click to select word, triple-click to select line
bind -T copy-mode-vi DoubleClick1Pane select-pane \; send-keys -X select-word
bind -T copy-mode-vi TripleClick1Pane select-pane \; send-keys -X select-line

# Paste with prefix + p
bind p paste-buffer

# -----------------------------------------------------------------------------
# Quality of life
# -----------------------------------------------------------------------------

# Reload config easily (prefix + r)
bind r source-file ~/.tmux.conf \; display-message "Config reloaded!"

# Kill pane without confirmation (prefix + x already does this but asks)
bind x kill-pane

# Kill window (prefix + X)
bind X kill-window

# Detach (prefix + d is default, but let's be explicit)
bind d detach-client

# Clear screen and history (prefix + C)
bind C send-keys -R \; clear-history \; display-message "Cleared!"

# Toggle synchronize-panes (type in all panes at once) - prefix + S
bind S setw synchronize-panes \; display-message "Sync: #{?synchronize-panes,ON,OFF}"

# -----------------------------------------------------------------------------
# Clean status bar (not overwhelming)
# -----------------------------------------------------------------------------

# Status bar position
set -g status-position bottom

# Update interval
set -g status-interval 5

# Colors - subtle dark theme
set -g status-style "bg=#1e1e2e,fg=#cdd6f4"

# Left side: session name
set -g status-left-length 30
set -g status-left "#[fg=#89b4fa,bold] #S #[fg=#6c7086]│ "

# Right side: just the basics
set -g status-right-length 50
set -g status-right "#[fg=#6c7086]│ #[fg=#a6adc8]%H:%M #[fg=#6c7086]│ #[fg=#a6adc8]%b %d "

# Window list styling
set -g window-status-format "#[fg=#6c7086] #I:#W "
set -g window-status-current-format "#[fg=#89b4fa,bold] #I:#W "
set -g window-status-separator ""

# Pane borders - subtle
set -g pane-border-style "fg=#313244"
set -g pane-active-border-style "fg=#89b4fa"

# Message styling
set -g message-style "bg=#1e1e2e,fg=#cdd6f4"
set -g message-command-style "bg=#1e1e2e,fg=#cdd6f4"

# -----------------------------------------------------------------------------
# Focus events (needed for some vim plugins)
# -----------------------------------------------------------------------------

set -g focus-events on

# -----------------------------------------------------------------------------
# Keep panes open on exit
# -----------------------------------------------------------------------------

set -g remain-on-exit on  # dead panes stay visible - useful for debugging
